<!DOCTYPE html>
<html lang="en-us">
    <head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Denis Kyashif" />
	
	<title>
		Resolving Ambiguity in Text Rewriting &middot; Denis Kyashif&#39;s Blog
	</title>
	
	
  	<link rel="stylesheet" href="/css/style.css" />    
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
	<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	<link rel="stylesheet" href="/assets/my.css">

	
	<link rel="icon" type="image/png" sizes="192x192" href="/images/icons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/icons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
	
	<link rel="apple-touch-icon" href="/images/icons/apple-icon.png" />
	<link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-57x57.png" />
	<link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-icon-60x60.png" />
	<link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-icon-72x72.png" />
	<link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-icon-76x76.png" />
	<link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-icon-114x114.png" />
	<link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-icon-120x120.png" />
	<link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-icon-144x144.png" />
	<link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-icon-152x152.png" />
	<link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-icon-180x180.png" />

	<link rel="manifest" href="/site.webmanifest">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/images/icons/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	
	
	<link href="" rel="alternate" type="application/rss+xml" title="Denis Kyashif&#39;s Blog" />
    <meta property="og:title" content="Resolving Ambiguity in Text Rewriting" />
<meta property="og:description" content="Strategies for resolving conflicts that occur when two replacement substrings overlap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://deniskyashif.com/2020/02/22/resolving-ambiguity-in-text-rewriting/" /><meta property="og:image" content="https://deniskyashif.com/images/posts/2020-02-22-ambiguity-text-rewriting/featured.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-22T09:10:37+02:00" />
<meta property="article:modified_time" content="2020-02-22T09:10:37+02:00" />

    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X7Z9LV9QY4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-X7Z9LV9QY4', { 'anonymize_ip': false });
}
</script>

</head>

    <body>
        <a href="https://github.com/deniskyashif/blog" class="github-corner" target="_blank" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#4a9ae1; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

<nav class="nav">
	<div class="nav-container">
        <a href="/">
			<h2 class="nav-title">Denis Kyashif&#39;s Blog</h2>
		</a>
		<ul>
    <li><a href="/">Posts</a></li>
    <li><a href="/talks">Talks</a></li>
    <li><a href="/about">About</a></li>
</ul>

	</div>
</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <time datetime="2020-02-22 09:10:37 &#43;0200 EET">February 22, 2020</time>
    |
    <a href="https://github.com/deniskyashif/blog/blob/master/content/posts/2020-02-22-ambiguity-in-text-rewriting.md" target="_blank">
        <i class="fa fa-edit"></i>&nbsp;Edit
    </a>

    
    <div class="tags">
        
        
        
        <a href="https://deniskyashif.com/tags/compsci/" class="tag">compsci</a>
        
        
        
        
        <a href="https://deniskyashif.com/tags/nlp/" class="tag">nlp</a>
        
        
    </div>
</div>

		<h1 class="post-title">Resolving Ambiguity in Text Rewriting</h1>
<div class="post-line"></div>

		

		<p>Text rewriting is the process of replacing parts of a text that matches some rewrite rules with other text. In some cases, however, these parts might overlap so we have to come up with a way to decide which one is to be replaced. In this article, we&rsquo;ll discuss several conflict resolution strategies and describe their implementations from a formal standpoint.<br>
This article builds on top of <a href="/2020/02/18/finite-state-transducers-for-text-rewriting/">Finite-State Transducers for Text-Rewriting</a> so check it out first, before proceeding with this one.</p>
<h2 id="ambiguity">Ambiguity</h2>
<p>Consider the following rewrite rule and suppose we have a finite-state transducer for obligatory replacement based on it.</p>
<p>\[
R_1 = ab|bc \to x
\]</p>
<p>and the following input text.</p>
<p>\[ aabcb \]</p>
<p>If we don&rsquo;t specify a conflict resolution strategy, the obligatory rewrite transducer for \(R_1\) will result in two distinct translations because the matches &ldquo;ab&rdquo; and &ldquo;bc&rdquo; clearly overlap.</p>
<p>\[
a \cdot ab \cdot cb \longmapsto_{R(T_{R_1})} axcb \\
aa \cdot bc \cdot b \longmapsto_{R(T_{R_1})} aaxb
\]</p>
<p>Let&rsquo;s see another example. A rewrite rule</p>
<p>\[
R_2 = aa*b|aa \to x
\]</p>
<p>and an input text</p>
<p>\[ aaaaabbaa \]</p>
<p>that results in even more valid decompositions.</p>
<p>\[
aaaaab \cdot b \cdot aa \longmapsto_{R(T_{R_2})} xbx \\
aa \cdot aaab \cdot b \cdot aa \longmapsto_{R(T_{R_2})} xxbx \\
aa \cdot aa \cdot ab \cdot b \cdot aa \longmapsto_{R(T_{R_2})} xxxbx
\]</p>
<p>A proper conflict resolution strategy would ensure that for each input text, we&rsquo;ll get a single output following this strategy.</p>
<h2 id="definitions">Definitions</h2>
<p>Let&rsquo;s provide some formal definitions that will make it easier for us to reason about the problem.</p>
<p>Given two strings \( u, v \in \Sigma^* \) we write \( u &lt; v \) if \( u \) is a <strong>prefix</strong> of \( v \) and \( u \leq v \) if \( u \) is a <strong>proper prefix</strong> of \( v \).</p>
<p>An <strong>infix occurence</strong> of an string \( v \) in text \( t \) is a triple \( \langle u, v, w \rangle \) such that \( t = u \cdot v \cdot w \). For example in text \( t = aabcb, \langle a, ab, cb \rangle \) and \( \langle aa, bc, b \rangle \) infix occurrences of the strings &ldquo;ab&rdquo; and &ldquo;bc&rdquo; respectively.</p>
<p>Two <strong>infix occurrences</strong> \( \langle u_1, v_1, w_1 \rangle \) and \( \langle u_2, v_2, w_2 \rangle \) of a text <strong>overlap</strong> if \( u_1 &lt; u_2 &lt; u_1 \cdot v_1 \).</p>
<img src="/images/posts/2020-02-22-ambiguity-text-rewriting/overlap.png" alt="infix overlap" width="500" />
<p class="text-center">
    <small>Figure 1: Overlapping infix occurrences</small>
</p>
<p>A <strong>set of infix occurrences</strong> \(A\) of the text t is said to be <strong>non-overlapping</strong> if two distinct infix occurrences of \(A\) never overlap. Let&rsquo;s see an example.</p>
<p>\[
t = aabbbccab \\
A = \{ \langle a, ab, bbccab \rangle, \langle aabb, bc, cab \rangle, \langle aabbbcc, ab, \epsilon \rangle \}
\]</p>
<h2 id="leftmost-longest-match">Leftmost-Longest Match</h2>
<p>The <em>leftmost-longest</em> match resolution strategy consists of two rules:</p>
<ol>
<li>For two overlapping texts, we pick the one that starts first in the natural (<em>left-to-right</em>) reading order.</li>
<li>For distinct matches starting at the same place, we pick the longest one.</li>
</ol>
<p>By applying the <em>leftmost-longest</em> strategy in the example above, we get rid of the ambiguity and, thus, end up with the following translations:</p>
<p>\[
aabcb \to_{R^{LML}(T_{R_1})} axcb \\
aaaaabbaa \to_{R^{LML}(T_{R_2})} xbx
\]</p>
<h3 id="formal-description">Formal Description</h3>
<p>We&rsquo;ve developed an intuition for this strategy, let&rsquo;s define it in formal terms so we can be precise. Given two sets of infix occurrences \(A, B\), we define the following functions:</p>
<p>\[
AFTER(A, B) = \{ \langle u, v, w \rangle \in A | \forall \langle u&rsquo;, v&rsquo;, w&rsquo; \rangle \in B : u&rsquo; \cdot v&rsquo; \leq u \land u&rsquo; &lt; u  \}
\]</p>
<p>\( AFTER \) selects from all infix occurrences in \( A \) the ones where the middle component \(v\) starts after all middle components of the set \(B\).</p>
<p>\[
LEFTMOST(A) = \{ \langle u, v, w \rangle \in A | \forall \langle u&rsquo;, v&rsquo;, w&rsquo; \rangle \in A : u \leq u&rsquo; \}
\]</p>
<p>\( LEFTMOST \) selects the infix occurrences where the middle components have the leftmost position. Note that we might have multiple such components that start from the same position.</p>
<p>\[
LONGEST(A) = \{ \langle u, v, w \rangle \in A | \forall \langle u&rsquo;, v&rsquo;, w&rsquo; \rangle \in A : u \neq u&rsquo; \lor v&rsquo; \leq v \}
\]</p>
<p>From the infix occurrences with a middle component starting from the same position, \( LONGEST \) selects the ones with the longest middle part.</p>
<p>Now we can define the function \( LML(A) \) which given a set of infix occurrences is going to return its subset consisting of the <em>leftmost-longest</em> ones.</p>
<p>\[
LML(A) := \bigcup\limits_{i=0}^{\infty} V_{i}
\]</p>
<p>Where the intermediate sets \( V_i \) are defined inductively.</p>
<p>\[
V_0 = \emptyset \\
V_{i+1} = V_i \cup LONGEST(LEFTMOST(AFTER(A,V_i)))
\]</p>
<p>\( LML(A) \) is always finite because \( A \) is finite. That is, after a certain induction step \( i, V_i \) will remain unchanged and that&rsquo;s when we break from the loop. At each step, we add at most one element to the resulting set.</p>
<p>Note that also all the infix occurrences in \( LML(A) \) are <strong>non-overlapping</strong> which leads to another useful property, that is, given a rewrite function \( T: \Sigma^+ \to \Sigma^* \) the obligatory rewrite relation \( R^{LML}(T) \) under the <em>leftmost-longest</em> match strategy is also a function. That is, because our replacement candidates don&rsquo;t overlap, we rewrite distinct regions in the input text. The original rewrite transducer representing a function means that we do not have the same rule mapping to more than one distinct outputs (e.g. \(ab \to x, ab \to y\)). This guarantees that given any input text, the obligatory rewrite transducer for <em>leftmost-longest</em> match \( T_{R^{LML}(T)} \) is always going to produce a single output.</p>
<h2 id="other-conflict-resolution-strategies">Other Conflict Resolution Strategies</h2>
<p>Now we&rsquo;ve defined the <em>leftmost-longest</em> match, it is trivial to modify the algorithm to obtain different replacement strategies. For example, for <em>leftmost-shortest</em>, we can replace the \(LONGEST\) function with</p>
<p>\[
SHORTEST(A) = \{ \langle u, v, w \rangle \in A | \forall \langle u&rsquo;, v&rsquo;, w&rsquo; \rangle \in A : u \neq u&rsquo; \lor v \leq v&rsquo; \}
\]</p>
<p>We can also pick the rightmost out of several overlapping infix occurrences by replacing \(LEFTMOST\) with</p>
<p>\[
RIGHTMOST(A) = \{ \langle u, v, w \rangle \in A | \forall \langle u&rsquo;, v&rsquo;, w&rsquo; \rangle \in A : u&rsquo; \leq u \}
\]</p>
<p>By combining those functions, we can define any strategy we want, however, from now on, we&rsquo;ll focus on the <em>leftmost-longest</em> as it is more applicable in practice. Most of the time, the reading order is from left to right and longer occurrences carry in general more information than the shorter ones.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this article, we discussed the problem of having overlapping replacement candidates in text rewriting. We defined the <em>leftmost-longest</em> match strategy for resolving such conflicts and learned how to implement it from a formal standpoint. By performing small modifications, we saw how to formally define other kinds of strategies like the <em>leftmost-shortest</em>, <em>rightmost-longest</em>, etc.</p>
<p>The problem for implementing a finite-state transducer, corresponding to the rewrite relation \( R^{LML} \) is already well explored. In the references you can find a few papers providing implementations which differ in complexity and performance.</p>
<p><strong>Part 1:</strong> <a href="/2020/02/18/finite-state-transducers-for-text-rewriting/">Finite-State Transducers for Text Rewriting</a></p>
<h2 id="references-and-further-reading">References and Further Reading</h2>
<ul>
<li>Implementation of a <a href="https://github.com/deniskyashif/ssfst">Subsetequential Transducer for Dictionary-Based Text Rewriting</a></li>
<li><a href="https://www.cambridge.org/core/books/finitestate-techniques/E21E748468F0310DA12A2CFAEB989185">&ldquo;Finite State Techniques - Automata, Transducers and Bimachines&rdquo; by Mihov &amp;
Schulz</a> Chapter 11.4 - Regular relations for left-most-longest match rewriting</li>
<li><a href="https://web.stanford.edu/~mjkay/Kaplan%26Kay.pdf">&ldquo;Regular Models for Phonological Rule Systems&rdquo; by Kaplan &amp; Kay</a></li>
<li><a href="https://web.stanford.edu/~laurik/publications/acl-96/acl96.pdf">&ldquo;Directed Replacement&rdquo; by Karttunnen</a></li>
<li><a href="https://web.stanford.edu/~laurik/publications/acl-95/acl95.html">&ldquo;The Replace Operator&rdquo; by Karttunnen</a></li>
<li><a href="https://www.researchgate.net/publication/2559820_Transducers_from_Rewrite_Rules_with_Backreferences">&ldquo;Transducers from Rewrite Rules with Backreferences&rdquo; by Gerdemann &amp; van Noord</a></li>
</ul>


		<section class="social-share">
    
    
    <a href="//twitter.com/share?url=https%3a%2f%2fdeniskyashif.com%2f2020%2f02%2f22%2fresolving-ambiguity-in-text-rewriting%2f&amp;text=Resolving%20Ambiguity%20in%20Text%20Rewriting&amp;via=deniskyashif" target="_blank" class="share-btn twitter">
        <i class="fa fa-2x fa-twitter"></i>
    </a>
    
    
    
    <a href="//reddit.com/submit?url=https%3a%2f%2fdeniskyashif.com%2f2020%2f02%2f22%2fresolving-ambiguity-in-text-rewriting%2f&amp;title=Resolving%20Ambiguity%20in%20Text%20Rewriting" target="_blank" class="share-btn reddit">
        <i class="fa fa-2x fa-reddit-alien"></i>
    </a>
    
    
    
    <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdeniskyashif.com%2f2020%2f02%2f22%2fresolving-ambiguity-in-text-rewriting%2f" target="_blank" class="share-btn facebook">
        <i class="fa fa-2x fa-facebook"></i>
    </a>
    
    
    
    <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdeniskyashif.com%2f2020%2f02%2f22%2fresolving-ambiguity-in-text-rewriting%2f&amp;title=Resolving%20Ambiguity%20in%20Text%20Rewriting" target="_blank" class="share-btn linkedin">
        <i class="fa fa-2x fa-linkedin"></i>
    </a>
    
    
    
    
    
    <a href="mailto:?subject=Check out 'Resolving%20Ambiguity%20in%20Text%20Rewriting' by Denis%20Kyashif&amp;body=https%3a%2f%2fdeniskyashif.com%2f2020%2f02%2f22%2fresolving-ambiguity-in-text-rewriting%2f" target="_blank" class="share-btn email">
        <i class="fa fa-2x fa-envelope"></i>
    </a>
    
</section>

<div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "deniskyashif" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




	</div>

	<div class="pagination">
		<a href="/2020/02/18/finite-state-transducers-for-text-rewriting/" class="left arrow">&#8592;</a>
		<a href="/2020/06/12/introduction-to-bimachines/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        <footer>
	<span>
		&copy;&nbsp;<time datetime="2023-04-24 20:11:07.780687 &#43;0300 EEST m=&#43;0.243356057">2023</time>&nbsp;<a href="/about">Denis Kyashif</a>
	</span>
    <br/>
</footer>

    </body>
</html>
